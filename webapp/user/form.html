<!DOCTYPE html>
<html lang="kr">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>index</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <style>
        .form-group {
            width: 20%;
            min-width: 130px;
            height:50px;
            vertical-align: middle;
        }
        .form-group label {
        }
        .form-control {
            float: right;
        }
        .btn-group {
            width: 50%;
            text-align: center;
        }
    </style>
</head>
<body>
<h1>회원가입</h1>
<form id="question" name="question" method="post" action="/user/create">
    <div class="form-group">
        <label for="userId">사용자아이디</label>
        <input type="text" id="userId" name="userId" class="form-control">
    </div>
    <div class="form-group">
        <label for="password">비밀번호</label>
        <input type="password" id="password" name="password" class="form-control">
    </div>
    <div class="form-group">
        <label for="name">이름</label>
        <input type="text" id="name" name="name" class="form-control">
    </div>
    <div class="form-group">
        <label for="email">이메일</label>
        <input type="email" id="email" name="email" class="form-control">
    </div>
    <div class="btn-group">
        <button onclick="ajax()">회원가입</button>
    </div>
</form>

<script>
function ajax() {
    var elem   = document.getElementById("question").elements;
    var url    = document.getElementById("question").action;
    var params = "";
    var value;

    for (var i = 0; i < elem.length; i++) {
        if (elem[i].tagName == "SELECT") {
            value = elem[i].options[elem[i].selectedIndex].value;
        } else {
            value = elem[i].value;
        }
        params += elem[i].name + "=" + encodeURIComponent(value) + "&";
    }

    myAjaxPost(url, params, function() {});
}

function myAjaxPost(url, data, callback) {
    var xhr = getXmlDoc();

    xhr.open('POST', url, true);
    xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

    xhr.onreadystatechange = function() {
        if (xhr.status === 201) {
            location.href='/user/success.html';
        }
    }

    xhr.send(data);
}


function getXmlDoc() {
    var xhr;

    if (window.XMLHttpRequest) {
        // code for IE7+, Firefox, Chrome, Opera, Safari
        xhr = new XMLHttpRequest();
    } else {
        // code for IE6, IE5
        xhr = new ActiveXObject("Microsoft.XMLHTTP");
    }

    return xhr;
}
</script>
</body>
</html>